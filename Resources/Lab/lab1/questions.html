<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-KK94CHFLLe+nY2dmCWGMq91rCGa5gtU4mk92HdvYe+M/SXH301p5ILy+dN9+nJOZ" crossorigin="anonymous">

    <link rel="stylesheet" href="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.css">

    <link rel="stylesheet" href="/~cs2521/23T3/static/style.css">
    
    

    <title>COMP2521 23T3 - 

Week 01 Lab
Exercise

</title>
  </head>
  <body class="d-flex flex-column" style="min-height: 100vh;">
    <nav class="navbar fixed-top navbar-expand-lg navbar-light no-print" id="header-navbar">
      <div class="container">
        <button class="navbar-toggler navbar-toggler-right"
                type="button" data-bs-toggle="collapse" data-bs-target="#navmenu"
                aria-controls="navmenu" aria-label="Toggle navigation" aria-expanded="false">
          <span class="navbar-toggler-icon"></span>
        </button>

        <a class="navbar-brand" href="https://www.cse.unsw.edu.au/~cs2521/23T3/">COMP2521 23T3</a>

        <div class="collapse navbar-collapse" id="navmenu">
          <ul class="navbar-nav mr-auto">
            <!--
            <li class="nav-item active"><a class="nav-link" href="#">Outline</a></li>
            <li class="nav-item active"><a class="nav-link" href="#">Forum</a></li>
            <li class="navbar-text px-2">|</li>
            -->

            
              <li class="nav-item active dropdown">
  <a role="button" class="nav-link dropdown-toggle" id="week-selector"
    href="#" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
    Week 01 <span class="caret"></span>
  </a>
  <div class="dropdown-menu" aria-labelledby="week-selector">
    
      <a class="dropdown-item" href="/~cs2521/23T3/lab/1/questions">
        Week 01
        
      </a>
    
      <a class="dropdown-item" href="/~cs2521/23T3/lab/2/questions">
        Week 02
        
      </a>
    
      <a class="dropdown-item" href="/~cs2521/23T3/lab/3/questions">
        Week 03
        
      </a>
    
      <a class="dropdown-item" href="/~cs2521/23T3/lab/4/questions">
        Week 04
        
      </a>
    
      <a class="dropdown-item" href="/~cs2521/23T3/lab/5/questions">
        Week 05
        
      </a>
    
      <a class="dropdown-item" href="/~cs2521/23T3/lab/7/questions">
        Week 07
        
      </a>
    
      <a class="dropdown-item" href="/~cs2521/23T3/lab/8/questions">
        Week 08
        
      </a>
    
      <a class="dropdown-item" href="/~cs2521/23T3/lab/9/questions">
        Week 09
        
      </a>
    
      <a class="dropdown-item" href="/~cs2521/23T3/lab/10/questions">
        Week 10
        
          (tutors only)
        
      </a>
    
      <a class="dropdown-item" href="/~cs2521/23T3/lab/11/questions">
        Week 11
        
      </a>
    
      <a class="dropdown-item" href="/~cs2521/23T3/lab/12/questions">
        Week 12
        
      </a>
    
      <a class="dropdown-item" href="/~cs2521/23T3/lab/13/questions">
        Week 13
        
      </a>
    
      <a class="dropdown-item" href="/~cs2521/23T3/lab/14/questions">
        Week 14
        
      </a>
    
      <a class="dropdown-item" href="/~cs2521/23T3/lab/15/questions">
        Week 15
        
      </a>
    
      <a class="dropdown-item" href="/~cs2521/23T3/lab/16/questions">
        Week 16
        
      </a>
    
      <a class="dropdown-item" href="/~cs2521/23T3/lab/17/questions">
        Week 17
        
      </a>
    
  </div>
</li>
              <li class="nav-item active dropdown">
  <a role="button" class="nav-link dropdown-toggle" id="classtype-selector"
    href="#" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
    Lab <span class="caret"></span>
  </a>
  <div class="dropdown-menu" aria-labelledby="classtype-selector">
    
  	  
  	    <a class="dropdown-item" href="/~cs2521/23T3/tut/1/questions">
  	      Tutorial
  	      
  	    </a>
  	  
    
  	  
  	    <a class="dropdown-item" href="/~cs2521/23T3/lab/1/questions">
  	      Lab
  	      
  	    </a>
  	  
    
  </div>
</li>
              <li class="nav-item active dropdown">
  <a role="button" class="nav-link dropdown-toggle" id="qa-selector"
    href="#" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
    
      Exercise
    
    
    <span class="caret"></span>
  </a>
  <div class="dropdown-menu" aria-labelledby="qa-selector">
    <a class="dropdown-item" href="/~cs2521/23T3/lab/1/questions">
      Exercise
      
      
    </a>
    <a class="dropdown-item" href="/~cs2521/23T3/lab/1/answers">
      Solution
      
      
        (tutors only)
      
    </a>
    
      <a class="dropdown-item" href="/~cs2521/23T3/lab/1/notes">
        Tutors' Notes (tutors only)
      </a>
    
  </div>
</li>
            
          </ul>
        </div>
      </div>
    </nav>

    
    <main class="container" aria-label="Content" style="flex: 1; padding-top: 4rem;">
      <header>
        <h1 class="text-center">
Week 01 Lab
Exercise
</h1>
        <h3 class="text-center">
Sanitizers, Makefiles and C Revision
</h3>
        
      </header>
      <div class="text-justify mt-4">
        




<section class="exercise">
<header><h3>Objectives</h3></header>

<p>In this lab, you will:</p>
<ul>
	<li>Get reacquainted with C programming</li>
	<li>Practice programming with arrays and linked lists</li>
	<li>Learn how to read and understand sanitizer error messages</li>
	<li>Learn how to use the <code>make</code> command</li>
</ul>
</section>



<section class="exercise">
<header><h3>Admin</h3></header>



<dl class="dl-horizontal">
	<dt>Marks</dt>
	<dd>5 (see the Assessment section for more details)</dd>
	<dt>Demo</dt>
	
		<dd>in the Week 1, 2 or 3 lab session</dd>
	
	<dt>Submit</dt>
	<dd>see the Submission section</dd>
	<dt>Deadline to submit to give</dt>
	<dd>2pm Monday of Week 2</dd>
	<dt>Late penalty</dt>
	<dd>0.2% per hour or part thereof, submissions later than 5 days not accepted</dd>
</dl>



</section>



<section class="exercise">
<header><h3>Background</h3></header>

<p>Welcome to COMP2521!</p>

<p>The aim of this lab exercise is to introduce you to the tooling used in COMP2521, as well as give you practice programming with arrays and linked lists, as many of the data structures we will be covering are built upon them.</p>

</section>

<section class="exercise">
<header><h3>Setting Up</h3></header>
<p>To keep your files manageable, it's worth doing each lab exercise in a separate directory (folder). We suggest creating a subdirectory in your home directory called "COMP2521", "cs2521" or "2521", and then creating subdirectories under that called "lab01", "lab02", etc.</p>

<p>Create a directory for this lab, change into it, and run the following command:</p>

<pre is="tty">
<kbd is="sh">unzip <a href="https://cgi.cse.unsw.edu.au/~cs2521/23T3/labs/week01/downloads/files.zip">/web/cs2521/23T3/labs/week01/downloads/files.zip</a></kbd>
</pre>

<p>If you're working at home, download <code>files.zip</code> by clicking on the above link and then unzip the downloaded file.</p>

<aside class="note">
In the example interactions, we assume that you are typing at a terminal emulator running a shell, and the shell is giving you a <code>$</code> prompt. All the text that you type is in <code><strong>monospace bold</strong></code>; and all the text that is printed to you is in <code>monospace</code>.
</aside>

<p>If you've done the above correctly, you should now have three subdirectories in your lab01 directory:</p>
<ul>
	<li><code>sanitizers</code>, which is for Part 1</li>
	<li><code>makefiles</code>, which is for Part 2</li>
	<li><code>revision</code>, which is for Part 3</li>
</ul>

</section>

<section class="exercise with-self">
<header><h3>Part 1 - Sanitizers üíßÔ∏èüëèÔ∏è</h3></header>

<p>In COMP1511/COMP1911, you used <a href="https://github.com/COMP1511UNSW/dcc" target="_blank"><code>dcc</code></a>, a compiler created at CSE which is intended to help novice programmers by providing easy-to-understand explanations.</p>

<p>In COMP2521, since you are no longer a novice programmer, we will be using <a href="https://clang.llvm.org/" target="_blank"><code>clang</code></a>, a real-world compiler! (Fun fact: <code>dcc</code> actually uses <code>clang</code>.)</p>

<p>When you used <code>dcc</code>, you always compiled your programs like this:</p>

<pre is="tty">
<kbd is="sh">dcc -o prog prog.c</kbd>
</pre>

<p>When using <code>clang</code>, there are three other flags which we always compile with: <code>-Wall</code>, <code>-Werror</code> and <code>-g</code>. <code>-Wall</code> causes the compiler to warn us about (almost) all possible syntax mistakes in our program, <code>-Werror</code> causes warnings to be treated like errors (which prevents the program from being compiled), and <code>-g</code> causes the compiler to generate debug information (such as line numbers and variable names), which can be used by debuggers such as <code>gdb</code>.</p>

<p>We also often compile with <a href="https://github.com/google/sanitizers" target="_blank">sanitizers</a>, which are tools that insert extra code into the program to detect various errors at runtime. Each sanitizer detects different kinds of errors. We use the following sanitizers:</p>

<ul>
	<li>AddressSanitizer (ASan): detects invalid memory accesses</li>
	<li>MemorySanitizer (MSan): detects uses of uninitialized memory</li>
	<li>UndefinedBehaviourSanitizer (UBSan): detects various kinds of undefined behaviour (e.g., integer overflow during addition)</li>
	<li>LeakSanitizer (LSan): detects memory leaks</li>
</ul>

<p>To compile with sanitizers, we use the <code>-fsanitize=</code> flag followed by a comma-separated list of sanitizers. For example, to compile a program with AddressSanitizer and UndefinedBehaviourSanitizer, we would use the following command:</p>

<pre is="tty">
<kbd is="sh">clang -Wall -Werror -g -fsanitize=address,undefined -o prog prog.c</kbd>
</pre>

<p>While it would be convenient to compile our program with all the sanitizers at once, not all the sanitizers are compatible with each other. For example, AddressSanitizer is not compatible with MemorySanitizer. Thus, to ensure our programs do not contain any errors detected by either sanitizer, we must compile and run our programs twice: once with AddressSanitizer, and once with MemorySanitizer.</p>

<p>Since the error messages produced by sanitizers are not as friendly or as easily comprehensible, the goal of this activity is to teach you the meaning of common error types and how to locate useful information in error messages.</p>

<h4>Example</h4>

<p>Sanitizers produce detailed error messages which describe the type of error, the line of code that triggered the error, and more.</p>

<p>Here is an example error message produced by AddressSanitizer (with important parts <b>bolded</b>):</p>

<pre style="white-space: pre">
=================================================================
==796003==ERROR: AddressSanitizer: <b>heap-use-after-free</b> on address 0x602000000018 at pc 0x0000004c877a bp 0x7ffc206af420 sp 0x7ffc206af418
<b>READ of size 8</b> at 0x602000000018 thread T0
    <b>#0 0x4c8779 in func /tmp/sanitizer-example/prog.c:49:15</b>
    <b>#1 0x4c8359 in main /tmp/sanitizer-example/prog.c:35:9</b>
    #2 0x7fa437b12d09 in __libc_start_main csu/../csu/libc-start.c:308:16
    #3 0x41e2b9 in _start (/tmp/sanitizer-example/prog+0x41e2b9)

0x602000000018 is located 8 bytes inside of 16-byte region [0x602000000010,0x602000000020)
freed by thread T0 here:
    <b>#0 0x4980ad in free (/tmp/sanitizer-example/prog+0x4980ad)</b>
    <b>#1 0x4c86cf in func /tmp/sanitizer-example/prog.c:48:2</b>
    <b>#2 0x4c8359 in main /tmp/sanitizer-example/prog.c:35:9</b>
    #3 0x7fa437b12d09 in __libc_start_main csu/../csu/libc-start.c:308:16

previously allocated by thread T0 here:
    <b>#0 0x49832d in malloc (/tmp/sanitizer-example/prog+0x49832d)</b>
    <b>#1 0x4c8066 in main /tmp/sanitizer-example/prog.c:21:20</b>
    #2 0x7fa437b12d09 in __libc_start_main csu/../csu/libc-start.c:308:16

SUMMARY: AddressSanitizer: heap-use-after-free /tmp/sanitizer-example/prog.c:49:15 in func
Shadow bytes around the buggy address:
...
==796003==ABORTING
</pre>

<p>Even without the program's source code, there are a number of things we can deduce from this message:</p>
<ul>
	<li>The type of error is "heap-use-after-free". This means the program freed a block of memory, and then tried to access it afterwards. It is an error to access a memory block after it has been freed, because by freeing it, the program is declaring that it can be reused for other purposes, and it has potentially been re-allocated for another purpose and overwritten with other data already.</li>
	<li>The error occurred when the program tried to read from a memory address.</li>
	<li>The error occurred in the <code>func</code> function, on line 49 of <code>prog.c</code>. This function was called by the <code>main</code> function on line 35 of <code>prog.c</code>.</li>
	<li>The memory block was 16 bytes, and was freed in the <code>func</code> function on line 48 of <code>prog.c</code>. This function was called by the <code>main</code> function on line 35 of <code>prog.c</code>.</li>
	<li>The memory block was allocated by <code>malloc</code>, which was called from the <code>main</code> function on line 21 of <code>prog.c</code>.</li>
</ul>

<div class="alert alert-primary mt-3">
<p><b>Tip:</b> The groups of lines starting with # are <i>stack traces</i>. Recall that when a program calls a function, a stack frame is created for it on the stack which remains until the function returns. A <i>stack trace</i> lists all the function calls that were on the stack <i>at a particular point in time</i> while the program was running, as well as the line that the program was up to in each function. Simply put, a stack trace is used to describe where a program was up to.</p>
<p>For example, consider the first stack trace in the above error message. This tells us that when the heap-use-after-free error occurred, the function calls on the stack (from earliest to latest) were:</p>
<ul>
	<li>_start</li>
	<li>__libc_start_main</li>
	<li>main (line 35)</li>
	<li>func (line 49)</li>
</ul>
<p>This tells us that the <code>main</code> function called the <code>func</code> function on line 35, and then the error occurred on line 49. You can ignore _start and __libc_start_main, as these are not part of the program's source code (these functions/procedures perform some initialisation for the program before the <code>main</code> function is actually called).</p>
</div>

<p>The <a href="https://comp2521unsw.github.io/sanitisers-guide/" target="_blank">COMP2521 Sanitisers Guide</a> (written by Franco Reyes, one of our awesome tutors) is a helpful guide that explains how to read error messages, and contains detailed explanations and examples for all common error types.</p>

<h4>Your task</h4>

<p>The <code>sanitizers/</code> directory contains several buggy programs. For each of the programs below, your task is to:</p>

<ul>
	<li>Compile the program as instructed</li>
	<li>Run the program until you get an error message from AddressSanitizer or MemorySanitizer</li>
	<li>With help from the <a href="https://comp2521unsw.github.io/sanitisers-guide/" target="_blank">Sanitisers Guide</a>, identify the following pieces of information from the error message:
		<ul>
			<li>The type of error, and what it means</li>
			<li>Whether the operation that triggered the error was a read or write</li>
			<li>The name of the function in which the error occurred, and the source file and line number of the instruction that triggered the error</li>
			<li>The series of functions that were on the function call stack when the error occurred</li>
			<li>The meaning of any other stack traces in the error message (these usually have a line of pink text above them)</li>
		</ul>
	</li>
	<li>Deduce how the program can be fixed (<b>but don't actually fix the program</b>)</li>
</ul>

<div class="alert alert-warning">
	<b>Do not fix the programs</b> - the purpose of this task is to learn how to interpret error messages. During lab marking, your tutor will ask you to reproduce the error messages, which won't be possible if you have fixed the programs.
</div>

<div class="card">
	<div class="card-body">
		<h5>Program 1: <code>listAddStart.c</code></h5>
		<p>The purpose of this program is to repeatedly read values and insert them at the beginning of a linked list. Here is the <i>intended</i> behaviour of the program:</p>

<pre is="tty">
<kbd is="sh">./listAddStart</kbd>
<span class="eof"></span>
[]
<kbd is="sh">./listAddStart</kbd>
<kbd>3 1 4 1 5</kbd>
<span class="eof"></span>
[5, 1, 4, 1, 3]
</pre>

		<p>Compile the program with the following command:</p>

<pre is="tty">
<kbd is="sh">clang -Wall -Werror -g -fsanitize=address,leak,undefined -o listAddStart listAddStart.c</span></kbd>
</pre>

		<div class="alert alert-warning mt-3 mb-0">
			<b>Reminder: Do not fix the programs</b> - the purpose of this task is to learn how to interpret error messages. During lab marking, your tutor will ask you to reproduce the error messages, which won't be possible if you have fixed the programs.
		</div>
	</div>
</div>


<div class="card mt-3">
	<div class="card-body">
		<h5>Program 2: <code>shuffleArray.c</code></h5>
		<p>The purpose of this program is to read values into an array and then shuffle the array. Here is the <i>intended</i> behaviour of the program:</p>

<pre is="tty">
<kbd is="sh">./shuffleArray</kbd>
Enter array size: <kbd>5</kbd>
Enter array values: <kbd>3 1 4 1 5</kbd>
Original array: [3, 1, 4, 1, 5]
Shuffled array: [1, 3, 1, 5, 4]
</pre>
		<p>Note that the program randomly shuffles the array, so it is expected to produce different outputs each time it is run.</p>

		<p>Compile the program with the following command:</p>

<pre is="tty">
<kbd is="sh">clang -Wall -Werror -g -fsanitize=address,leak,undefined -o shuffleArray shuffleArray.c</kbd>
</pre>

		<div class="alert alert-success mt-3 mb-0">
			<b>Hint:</b> Note that unlike Program 1, the error in this program will occur in a function that is not in the source code (as there is no function called <code>scanf_common</code> in <code>shuffleArray.c</code>). This suggests that the error occurred in a library function. In this case, you should look further down the function call stack until you find a function that exists in the source code.
		</div>
	</div>
</div>


<div class="card mt-3">
	<div class="card-body">
		<h5>Program 3: <code>reverseArray.c</code></h5>
		<p>The purpose of this program is to read values into an array and then reverse the array. Here is the <i>intended</i> behaviour of the program:</p>

<pre is="tty">
<kbd is="sh">./reverseArray</kbd>
Enter array size: <kbd>5</kbd>
Enter array values: <kbd>3 1 4 1 5</kbd>
Original array: [3, 1, 4, 1, 5]
Reversed array: [5, 1, 4, 1, 3]
</pre>

		<p>Compile the program with the following command:</p>

<pre is="tty">
<kbd is="sh">clang -Wall -Werror -g -fsanitize=address,leak,undefined -o reverseArray reverseArray.c</kbd>
</pre>
	</div>
</div>


<div class="card mt-3">
	<div class="card-body">
		<h5>Program 4: <code>listPrepend.c</code></h5>
		<p>The purpose of this program is to read values and insert them at the beginning of a list. Here is the <i>intended</i> behaviour of the program:</p>

<pre is="tty">
<kbd is="sh">./listPrepend</kbd>
<kbd>3 1 4 1 5</kbd>
<span class="eof"></span>
[5, 1, 4, 1, 3]
</pre>

		<p>Compile the program with the following command:</p>

<pre is="tty">
<kbd is="sh">clang -Wall -Werror -g -fsanitize=address,leak,undefined -o listPrepend listPrepend.c</kbd>
</pre>
	</div>
</div>


<div class="card mt-3">
	<div class="card-body">
		<h5>Program 5: <code>listAppend.c</code></h5>
		<p>The purpose of this program is to read values and insert them at the end of a list. Here is the <i>intended</i> behaviour of the program:</p>

<pre is="tty">
<kbd is="sh">./listAppend</kbd>
<kbd>3 1 4 1 5</kbd>
<span class="eof"></span>
[3, 1, 4, 1, 5]
</pre>

		<p>Compile the program with the following command:</p>

<pre is="tty">
<kbd is="sh">clang -Wall -Werror -g -fsanitize=address,leak,undefined -o listAppend listAppend.c</kbd>
</pre>
	</div>
</div>


<div class="card mt-3">
	<div class="card-body">
		<h5>Program 6: <code>listDeleteFirst.c</code></h5>
		<p>The purpose of this program is to read values into a list and then delete the first value. Here is the <i>intended</i> behaviour of the program:</p>

<pre is="tty">
<kbd is="sh">./listDeleteFirst</kbd>
<kbd>3 1 4 1 5</kbd>
<span class="eof"></span>
List before: [3, 1, 4, 1, 5]
List after: [1, 4, 1, 5]
</pre>

		<p>Compile the program with the following command:</p>

<pre is="tty">
<kbd is="sh">clang -Wall -Werror -g -fsanitize=address,leak,undefined -o listDeleteFirst listDeleteFirst.c</kbd>
</pre>
	</div>
</div>


<div class="card mt-3">
	<div class="card-body">
		<h5>Program 7: <code>listNumEvens.c</code></h5>
		<p>The purpose of this program is to read values into a list and then count the number of even values. Here is the <i>intended</i> behaviour of the program:</p>

<pre is="tty">
<kbd is="sh">./listNumEvens</kbd>
<kbd>3 1 4 1 5</kbd>
<span class="eof"></span>
Number of even values: 1
</pre>

		<p>This program does not contain any errors that would be detected by AddressSanitizer, but it does contain errors that would be detected by MemorySanitizer. Compile the program with the following command:</p>

<pre is="tty">
<kbd is="sh">clang -Wall -Werror -g -fsanitize=memory,undefined -fsanitize-memory-track-origins -o listNumEvens listNumEvens.c</kbd>
</pre>
	</div>
</div>


<div class="card mt-3">
	<div class="card-body">
		<h5>Program 8: <code>mostFrequentLetter.c</code></h5>
		<p>The purpose of this program is to read a line of text and then determine the most frequent letter. Here is the <i>intended</i> behaviour of the program:</p>

<pre is="tty">
<kbd is="sh">./mostFrequentLetter</kbd>
Enter some text: <kbd>the quick brown fox jumps over the lazy dog</kbd>
The most frequent letter is: o
</pre>

		<p>Compile the program with the following command:</p>

<pre is="tty">
<kbd is="sh">clang -Wall -Werror -g -fsanitize=memory,undefined -fsanitize-memory-track-origins -o mostFrequentLetter mostFrequentLetter.c</kbd>
</pre>

		<div class="alert alert-warning mt-3 mb-0">
			<b>Reminder: Do not fix the programs</b> - the purpose of this task is to learn how to interpret error messages. During lab marking, your tutor will ask you to reproduce the error messages, which won't be possible if you have fixed the programs.
		</div>
	</div>
</div>

</section>

<section class="exercise with-self">
<header><h3>Part 2 - Makefiles üõ†Ô∏è</h3></header>

<div class="alert alert-primary">
The purpose of this section is to explain how Makefiles will be used in this course and give you enough background on Makefiles for you to be able to use the <code>make</code> command. You won't be assessed on your understanding of Makefiles and <code>make</code>.
</div>

<p>If you got tired of typing out the compilation commands in Part 1, you're not alone! In COMP2521, we will usually not type out the compilation commands to compile our programs; instead, we will use Makefiles and the <code>make</code> command.</p>

<p>A Makefile is a file that specifies the build products of a project, their dependencies (e.g., source code files) and instructions for building them (e.g., compilation commands). If a Makefile exists, the <code>make</code> command will use the Makefile to determine what needs to be built (or rebuilt), and then run the commands needed to build them.</p>

<p>The main benefit of using Makefiles is that <code>make</code> uses the modification timestamps of files to decide whether something needs to be rebuilt, and does not rebuild something if its dependencies have not been modified since it was last built. This means, for example, if we have only modified one file since we last ran <code>make</code>, and then we run <code>make</code> again, only parts of the project that depend on the file we modified will be rebuilt. This saves a lot of build time in larger projects.</p>

<p>In COMP2521, we will always provide Makefiles for any coding activity, including in labs, assignments and the exam, so you don't need to know how to write a Makefile. However, you should know how to run the <code>make</code> command.</p>

<p>Let's take a look at a simple Makefile. Here is the Makefile from the <code>makefiles</code> directory of this lab:</p>

<pre>
CC = clang
CFLAGS = -Wall -Wvla -Werror -g

########################################################################

asan: CFLAGS += -fsanitize=address,leak,undefined
asan: all

msan: CFLAGS += -fsanitize=memory,undefined -fsanitize-memory-track-origins
msan: all

nosan: all

########################################################################

all: listAddStart mostFrequentLetter

listAddStart: listAddStart.c
	$(CC) $(CFLAGS) -o listAddStart listAddStart.c

mostFrequentLetter: mostFrequentLetter.c
	$(CC) $(CFLAGS) -o mostFrequentLetter mostFrequentLetter.c

########################################################################

clean:
	rm -f listAddStart mostFrequentLetter
</pre>

<p>The important thing to note here are the <em>targets</em>, which are the words that appear before a colon. The targets in this Makefile are: <code>asan</code>, <code>msan</code>, <code>nosan</code>, <code>all</code>, <code>listAddStart</code>, <code>mostFrequentLetter</code> and <code>clean</code>. Note that some targets refer to actual files that will be produced (<code>listAddStart</code> and <code>mostFrequentLetter</code>), while the other targets don't refer to actual files. When we run <code>make</code>, we can either specify one or more targets to build, or not specify any targets, in which case <code>make</code> will simply build the first target in the Makefile.</p>

<p>The dependencies of a target are listed after the colon on the same line. For example, the <code>asan</code> target has one dependency, which is the <code>all</code> target. Meanwhile, the <code>all</code> target has two dependencies: <code>listAddStart</code> and <code>mostFrequentLetter</code>.</p>

<p>It's time to try out the <code>make</code> command! Change to the <code>makefiles/</code> directory, then run <code>make</code>. You should get the following output:</p>

<pre is="tty">
<kbd is="sh">make</kbd>
clang -Wall -Wvla -Werror -g -fsanitize=address,leak,undefined -o listAddStart listAddStart.c
clang -Wall -Wvla -Werror -g -fsanitize=address,leak,undefined -o mostFrequentLetter mostFrequentLetter.c
</pre>

<p>You may be wondering why <code>make</code> compiled <code>listAddStart</code> and <code>mostFrequentLetter</code> when the first target in the Makefile is <code>asan</code>. That is because <code>listAddStart</code> and <code>mostFrequentLetter</code> are indirect dependencies of the <code>asan</code> target - the <code>asan</code> target depends on the <code>all</code> target, which depends on <code>listAddStart</code> and <code>mostFrequentLetter</code>.</p>

<p>Let's see what happens if we try to run <code>make</code> again. You should get the following output:</p>

<pre is="tty">
<kbd is="sh">make</kbd>
make: Nothing to be done for 'asan'.
</pre>

<p>Since the dependencies of <code>asan</code> have not been modified since we last ran <code>make</code>, <code>make</code> deduces that nothing needs to be rebuilt, and thus outputs "Nothing to be done".</p>

<p>As we mentioned before, in Makefiles, you can create targets which don't actually refer to real files. This can be useful because (1) you may want to automate tasks that don't involve any compilation, but are still related to the compilation process or (2) you may want to compile the same program in different ways. For example, in all of our Makefiles, we will provide a target called "clean" which removes all build products from the directory. To use it, specify the <code>clean</code> target. You should get the following output:</p>

<pre is="tty">
<kbd is="sh">make clean</kbd>
rm -f listAddStart mostFrequentLetter
</pre>

<p>We will also include a few targets to let you specify what sanitizers you want to compile with, as not all sanitizers are compatible with each other. Since AddressSanitizer is the most useful sanitizer, this is what <code>make</code> will compile with if you run it without any arguments (which you've seen above). However, you can explicitly state that you want to compile with AddressSanitizer like so:</p>

<pre is="tty">
<kbd is="sh">make asan</kbd>
</pre>

<p>If you want to compile with MemorySanitizer, then you must specify the <code>msan</code> target, like so:</p>

<pre is="tty">
<kbd is="sh">make msan</kbd>
</pre>

<p>If you wish to compile without any sanitizers, which you should only need to do if you want to use <code>valgrind</code>, then you must specify the <code>nosan</code> target like so:</p>

<pre is="tty">
<kbd is="sh">make nosan</kbd>
</pre>

<p>Note that if you build each of these targets one after the other without modifying any files in between, <code>make</code> will not rebuild the programs and instead output "Nothing to be done". This is because even though <code>asan</code>, <code>msan</code> and <code>nosan</code> are different targets, they all have the same base dependencies (<code>listAddStart.c</code> and <code>mostFrequentLetter.c</code>), which have not been modified. If you want to compile a program with AddressSanitizer, and then compile it again with MemorySanitizer, you will need to run <code>make clean</code> in between.</p>

<h4>Your task</h4>

<p>The <code>makefiles/</code> directory contains two buggy programs. One of these programs contains an error that will be caught by AddressSanitizer, while the other program contains an error that will be caught by MemorySanitizer. Your task is to use the <code>make</code> command to compile with each sanitizer, and show (to yourself) that each program produces an error message when compiled with one of the sanitizers, but not the other.</p>

</section>

<section class="exercise with-self">
<header><h3>Part 3 - Revision Exercises üí™Ô∏è</h3></header>

<p>The remainder of this lab exercise consists of some array and linked list exercises to give you some practice programming with them again. These exercises are in the <code>revision/</code> directory.</p>

<div class="card mt-3">
	<div class="card-body">
		<h4>Task 1 - Shifting an Array</h4>
		<p>Your task is to implement the following function in <code>arrayShift.c</code>:</p>

<div class="highlight"><pre><span></span><span class="kt">void</span><span class="w"> </span><span class="nf">shift</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">arr</span><span class="p">[],</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">size</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">n</span><span class="p">);</span>
</pre></div>


		<p>This function <i>shifts</i> an array of the given size <em>to the right</em> \( n \) times. When an array is shifted to the right, each element is moved one index to the right (i.e., if an element was at index \(i\), it will now be at index \(i + 1\)), and the element at the end of the array (at index \(N - 1\) where \(N\) is the size of the array) is moved to the start (index \(0\)).</p>

		<p>\(n\) can be assumed to be non-negative.</p>

		<h5>Testing</h5>
		<p><code>arrayShift.c</code> contains a main function which allows you to test your <code>shift</code> function. The main function:</p>

		<ul>
			<li>Reads the size of the array</li>
			<li>Reads the values of the array</li>
			<li>Displays the array</li>
			<li>Reads the value of \(n\)</li>
			<li>Calls <code>shift</code></li>
			<li>Displays the updated array</li>
		</ul>

		<p>Here are some examples of its usage:</p>
<pre is="tty">
<kbd is="sh">make</kbd>
...
<kbd is="sh">./arrayShift</kbd>
Enter array size: <kbd>3</kbd>
Enter array values: <kbd>16 5 2</kbd>
Array: [16, 5, 2]
Enter shift: <kbd>1</kbd>
Array after shifting 1 time(s): [2, 16, 5]
<kbd is="sh">./arrayShift</kbd>
Enter array size: <kbd>5</kbd>
Enter array values: <kbd>16 5 2 -3 4</kbd>
Array: [16, 5, 2, -3, 4]
Enter shift: <kbd>3</kbd>
Array after shifting 3 time(s): [2, -3, 4, 16, 5]
<kbd is="sh">./arrayShift</kbd>
Enter array size: <kbd>5</kbd>
Enter array values: <kbd>16 5 2 -3 4</kbd>
Array: [16, 5, 2, -3, 4]
Enter shift: <kbd>10</kbd>
Array after shifting 10 time(s): [16, 5, 2, -3, 4]
</pre>
	</div>
</div>


<div class="card mt-3">
	<div class="card-body">
		<h4>Task 2 - Shifting a Linked List</h4>
		<p>Your task is to implement the following function in <code>listShift.c</code>:</p>

<div class="highlight"><pre><span></span><span class="k">struct</span><span class="w"> </span><span class="nc">node</span><span class="w"> </span><span class="o">*</span><span class="n">shift</span><span class="p">(</span><span class="k">struct</span><span class="w"> </span><span class="nc">node</span><span class="w"> </span><span class="o">*</span><span class="n">list</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">n</span><span class="p">);</span>
</pre></div>


		<p>This function <i>shifts</i> a linked list <em>to the right</em> \( n \) times and returns a pointer to the start of the updated list. When a linked list is shifted to the right, the node at the end of the list is moved to the start.</p>

		<p>\(n\) can be assumed to be non-negative.</p>

		<h5>Constraints</h5>
		<ul>
			<li>You must not use <code>malloc</code> or any of its variants</li>
			<li>You must not modify the values in any nodes</li>
		</ul>

		<h5>Testing</h5>
		<p><code>listShift.c</code> contains a main function which allows you to test your <code>shift</code> function. The main function:</p>

		<ul>
			<li>Reads the size of the list</li>
			<li>Reads the values of the list</li>
			<li>Displays the list</li>
			<li>Reads the value of \(n\)</li>
			<li>Calls <code>shift</code></li>
			<li>Displays the updated list</li>
		</ul>

		<p>Here are some examples of its usage:</p>
<pre is="tty">
<kbd is="sh">make</kbd>
...
<kbd is="sh">./listShift</kbd>
Enter list size: <kbd>3</kbd>
Enter list values: <kbd>16 5 2</kbd>
List: [16, 5, 2]
Enter shift: <kbd>1</kbd>
List after shifting 1 time(s): [2, 16, 5]
<kbd is="sh">./listShift</kbd>
Enter list size: <kbd>5</kbd>
Enter list values: <kbd>16 5 2 -3 4</kbd>
List: [16, 5, 2, -3, 4]
Enter shift: <kbd>3</kbd>
List after shifting 3 time(s): [2, -3, 4, 16, 5]
<kbd is="sh">./listShift</kbd>
Enter list size: <kbd>5</kbd>
Enter list values: <kbd>16 5 2 -3 4</kbd>
List: [16, 5, 2, -3, 4]
Enter shift: <kbd>10</kbd>
List after shifting 10 time(s): [16, 5, 2, -3, 4]
</pre>
	</div>
</div>


<div class="card mt-3">
	<div class="card-body">
		<h4>Task 3 - Inserting into an Ordered Array</h4>
		<p>Your task is to implement the following function in <code>arrayInsertOrdered.c</code>:</p>

<div class="highlight"><pre><span></span><span class="kt">void</span><span class="w"> </span><span class="nf">insertOrdered</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">arr</span><span class="p">[],</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">size</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">value</span><span class="p">);</span>
</pre></div>


		<p>This function takes an array which is sorted in increasing order, and inserts the given value into the array such that the array remains ordered.</p>
		
		<div class="alert alert-secondary">
			<p>The function can assume that it can store an element at index <code>size</code>. For example, suppose that the inputs are:</p>

			<img src="./images/array-insert-ordered-1.svg" class="center w-65" />

			<p>Then the value should be inserted like so:</p>

			<img src="./images/array-insert-ordered-2.svg" class="center w-35" />
		</div>

		<h5>Testing</h5>
		<p><code>arrayInsertOrdered.c</code> contains a main function which allows you to test your <code>insertOrdered</code> function. The main function:</p>

		<ul>
			<li>Reads the size of the array</li>
			<li>Reads the values of the array</li>
			<li>Displays the array</li>
			<li>Reads the value to be inserted</li>
			<li>Calls <code>insertOrdered</code></li>
			<li>Displays the updated array</li>
		</ul>

		<p>Here are some examples of its usage:</p>
<pre is="tty">
<kbd is="sh">make</kbd>
...
<kbd is="sh">./arrayInsertOrdered</kbd>
Enter array size: <kbd>4</kbd>
Enter array values (must be in ascending order): <kbd>2 5 7 8</kbd>
Array: [2, 5, 7, 8]
Enter value to insert: <kbd>6</kbd>
Array after inserting 6: [2, 5, 6, 7, 8]
<kbd is="sh">./arrayInsertOrdered</kbd>
Enter array size: <kbd>5</kbd>
Enter array values (must be in ascending order): <kbd>-8 -3 -1 2 4</kbd>
Array: [-8, -3, -1, 2, 4]
Enter value to insert: <kbd>-9</kbd>
Array after inserting -9: [-9, -8, -3, -1, 2, 4]
<kbd is="sh">./arrayInsertOrdered</kbd>
Enter array size: <kbd>6</kbd>
Enter array values (must be in ascending order): <kbd>-5 0 2 6 9 14</kbd>
Array: [-5, 0, 2, 6, 9, 14]
Enter value to insert: <kbd>2</kbd>
Array after inserting 2: [-5, 0, 2, 2, 6, 9, 14]
</pre>

	</div>
</div>


<div class="card mt-3">
	<div class="card-body">
		<h4>Task 4 - Inserting into an Ordered Linked List</h4>
		<p>Your task is to implement the following function in <code>listInsertOrdered.c</code>:</p>

<div class="highlight"><pre><span></span><span class="k">struct</span><span class="w"> </span><span class="nc">node</span><span class="w"> </span><span class="o">*</span><span class="n">insertOrdered</span><span class="p">(</span><span class="k">struct</span><span class="w"> </span><span class="nc">node</span><span class="w"> </span><span class="o">*</span><span class="n">list</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">value</span><span class="p">);</span>
</pre></div>


		<p>This function takes a linked list which is sorted in increasing order, inserts the given value into the list such that the list remains ordered, and then returns a pointer to the start of the updated list.</p>

		<h5>Testing</h5>
		<p><code>listInsertOrdered.c</code> contains a main function which allows you to test your <code>insertOrdered</code> function. The main function:</p>

		<ul>
			<li>Reads the size of the list</li>
			<li>Reads the values of the list</li>
			<li>Displays the list</li>
			<li>Reads the value to be inserted</li>
			<li>Calls <code>insertOrdered</code></li>
			<li>Displays the updated list</li>
		</ul>

		<p>Here are some examples of its usage:</p>
<pre is="tty">
<kbd is="sh">make</kbd>
...
<kbd is="sh">./listInsertOrdered</kbd>
Enter list size: <kbd>4</kbd>
Enter list values (must be in ascending order): <kbd>2 5 7 8</kbd>
List: [2, 5, 7, 8]
Enter value to insert: <kbd>6</kbd>
List after inserting 6: [2, 5, 6, 7, 8]
<kbd is="sh">./listInsertOrdered</kbd>
Enter list size: <kbd>5</kbd>
Enter list values (must be in ascending order): <kbd>-8 -3 -1 2 4</kbd>
List: [-8, -3, -1, 2, 4]
Enter value to insert: <kbd>-9</kbd>
List after inserting -9: [-9, -8, -3, -1, 2, 4]
<kbd is="sh">./listInsertOrdered</kbd>
Enter list size: <kbd>6</kbd>
Enter list values (must be in ascending order): <kbd>-5 0 2 6 9 14</kbd>
List: [-5, 0, 2, 6, 9, 14]
Enter value to insert: <kbd>2</kbd>
List after inserting 2: [-5, 0, 2, 2, 6, 9, 14]
</pre>

	</div>
</div>

<div class="card mt-3">
	<div class="card-body">
		<h4>Optional Challenge Task</h4>
		<p><b>Note:</b> This task is <b>optional</b>. It is not marked.</p>
		<p>In tasks 1 and 2, implement the <code>shift</code> function without using any nested loops (non-nested loops are fine) and without using <code>malloc</code>, <code>calloc</code> or any temporary arrays.</p>
	</div>
</div>

</section>



<section class="exercise">
<header><h3>Submission</h3></header>
<p>Submit via the command line using the <code>give</code> command:</p>

<pre is="tty">
<kbd is="sh">give cs2521 lab01 arrayShift.c listShift.c arrayInsertOrdered.c listInsertOrdered.c</kbd>
</pre>

<p>You can also submit via <a href="https://cgi.cse.unsw.edu.au/~give/Student/give.php" target="_blank">give's web interface</a>. You can submit multiple times. Only your last submission will be marked. You can check the files you have submitted <a href="https://cgi.cse.unsw.edu.au/~cs2521/23T3/view/main.cgi/" target="_blank">here</a>.</p>

<aside class="warning">
	<p>After you submit, you must check that your submission was successful by going to your <a href="https://cgi.cse.unsw.edu.au/~cs2521/23T3/view/main.cgi/" target="_blank">submissions page</a>. Check that the timestamp is correct. If your submission does not appear under Last Submission or the timestamp is not correct, then resubmit.</p>
</aside>
</section>

<section class="exercise">
<header><h3>Assessment</h3></header>
<p>Parts 1 and 2 will be handmarked, and Part 3 will be automarked. Please note that handmarking must be completed in Weeks 1, 2 or 3; you cannot ask your tutor to handmark your lab01 work in Week 4 or later (they won't be able to enter your mark). The marking criteria are as follows:</p>

<table class="table table-sm table-bordered">
	<thead>
		<tr>
			<th width="15%">Part</th>
			<th>Marks</th>
			<th>Criteria</th>
		</tr>
	</thead>
	<tbody>
		<tr>
			<td>Part 1 - Sanitizers</td>
			<td>2</td>
			<td>Your tutor will pick two programs from the list of programs in Part 1. For each program, they will ask you to run the program until AddressSanitizer or MemorySanitizer produces an error message, and then ask you identify the following:
				<ul>
					<li>The type of error, and what it means</li>
					<li>Whether the operation that triggered the error was a read or write</li>
					<li>The name of the function in which the error occurred, and the source file and line number of the instruction that triggered the error</li>
					<li>The series of functions on the function call stack when the error occurred</li>
					<li>The meaning of any other stack traces in the error message, <em>or</em> how the error can be fixed (you don't need to actually fix it, you just need to describe how it can be fixed)</li>
				</ul>
			</td>
		</tr>
		<tr>
			<td>Part 2 - Makefiles</td>
			<td>1</td>
			<td>Your tutor will ask you to use the <code>make</code> command to compile the programs in the <code>makefiles</code> directory, and show that each program produces an error message when compiled with one of the sanitizers, but not the other.</td>
		</tr>
		<tr>
			<td>Part 3 - Revision Exercises</td>
			<td>2</td>
			<td>0.5 marks per task. Automarking will be run after submissions have closed. After automarking is run you will be able to view your results <a href="https://cgi.cse.unsw.edu.au/~cs2521/23T3/view/main.cgi/" target="_blank">here</a>. 
			</td>
		</tr>
	</tbody>
</table>







      </div>
    </main>

    <footer class="mt-3 py-3 bg-dark text-center no-print" data-bs-theme="dark">
      <p class="text-muted">
        <small>
          <strong>COMP2521 23T3: Data Structures and Algorithms</strong>
          is brought to you by<br/>
          the <a href="https://www.cse.unsw.edu.au/">School of Computer Science and Engineering</a><br/>
          at the <a href="https://www.unsw.edu.au/">University of New South Wales</a>, Sydney.<br/>
          For all enquiries, please email the class account at
          <a href="mailto:cs2521@cse.unsw.edu.au">cs2521@cse.unsw.edu.au</a><br/>
          
          CRICOS Provider 00098G
        </small>
      </p>
    </footer>
    
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha3/dist/js/bootstrap.bundle.min.js" integrity="sha384-ENjdO4Dr2bkBIFxQpeoTz1HIcje39Wm4jDKdf19U8gI4ddQ3GYNS7NTKfAdVQSZe" crossorigin="anonymous"></script>

    <!-- math -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-MML-AM_CHTML" async></script>
    
    
  </body>
</html>